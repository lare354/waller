#!/bin/bash

#    ▖  ▖  ▜ ▜             
#    ▌▞▖▌▀▌▐ ▐ █▌▛▘        
#    ▛ ▝▌█▌▐▖▐▖▙▖▌         
#                          
#    ▗▄▖▜       ▄▖▄▖▖▖   ▄▖
#    ▌▄▐▐ ▀▌▛▘█▌▄▌▙▖▙▌  ▘▄▌
#    ▌▀▀▐▖█▌▌ ▙▖▄▌▄▌ ▌  ▖▄▌
#     ▀                                                                                    


cacheDir=$HOME/.cache/waller
confDir=$HOME/.config/waller
conf=$confDir/waller.conf
rasi=$confDir/waller.rasi

rofiCmd="rofi -dmenu -theme ${rasi}"

. $conf


# Select a picture with rofi
wallSelection=$(for wall in "$wallsDir"*; do echo -en "$wall\0icon\x1fthumbnail://$wall\n" ; done | $rofiCmd)

# Set the wallpaper
[[ -n "$wallSelection" ]] || exit 1

if ! $blur; then
	swww img ${wallSelection}
	exit 0	
fi

blurLvl="0x4"

if ! $softBlur; then
	blurLvl="0x8"
fi

wallName=$(basename "${wallSelection}")

magick ${wallSelection} -scale 50% -blur "${blurLvl}" -resize 200% "${cacheDir}/blurred_${wallName}" 

swww img "${cacheDir}/blurred_${wallName}"

exit 0
